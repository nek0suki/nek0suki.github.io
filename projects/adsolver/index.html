<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Automatic-Differentiation Rigidbody Dynamics | Zeyu Wang </title> <meta name="author" content="Zeyu Wang"> <meta name="description" content="A Toy Python Module"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nek0suki.github.io/projects/adsolver/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Zeyu</span> Wang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Automatic-Differentiation Rigidbody Dynamics</h1> <p class="post-description">A Toy Python Module</p> </header> <article> <p>This project implements forward and reverse mode automatic differentiation mechanism in compiler for the <a href="https://github.com/BachiLi/loma_public" rel="external nofollow noopener" target="_blank">loma</a> programming language.</p> <p>After that, a toy python module is developed to derive the trajectories of mass points given arbitrary coordinate system and potential energy function. Leveraging Hamiltonian mechanics, it automatically computes the Jacobian and Hessian tensors and figures out the equation of motion.</p> <p>Some examples include:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/AdSolver/triple_pendulum.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Triple Pendulum </div> <p>Corresponding code:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def sys_coords(q : In[MatrixMN]) -&gt; MatrixMN:
    l1 : float = 5
    l2 : float = 5
    l3 : float = 5

    ori_x : float = 0
    ori_y : float = 0

    theta1 : float = q.arr[0]
    theta2 : float = q.arr[1]
    theta3 : float = q.arr[2]

    x1 : float = -l1 * sin(theta1) + ori_x
    y1 : float = -l1 * cos(theta1) + ori_y
    x2 : float = -l2 * sin(theta2) + x1
    y2 : float = -l2 * cos(theta2) + y1
    x3 : float = -l3 * sin(theta3) + x2
    y3 : float = -l3 * cos(theta3) + y2

    x : MatrixMN
    x.m = 6
    x.n = 1
    x.arr[0] = x1
    x.arr[1] = y1
    x.arr[2] = x2
    x.arr[3] = y2
    x.arr[4] = x3
    x.arr[5] = y3
    return x

def sys_potential(q : In[MatrixMN], m : In[MatrixMN]) -&gt; float:
    x : MatrixMN = sys_coords(q)
    g : float = 9.8
    return (x.arr[1] * m.arr[1] + x.arr[3] * m.arr[3] + x.arr[5] * m.arr[5]) * g
</code></pre></div></div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/AdSolver/three_body.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Three-Body </div> <p>Corresponding code:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def sys_coords(q : In[MatrixMN]) -&gt; MatrixMN:
    r1 : float = q.arr[0]
    theta1 : float = q.arr[1]
    r2 : float = q.arr[2]
    theta2 : float = q.arr[3]
    r3 : float = q.arr[4]
    theta3 : float = q.arr[5]

    x1 : float = cos(theta1) * r1
    y1 : float = sin(theta1) * r1
    x2 : float = cos(theta2) * r2
    y2 : float = sin(theta2) * r2
    x3 : float = cos(theta3) * r3
    y3 : float = sin(theta3) * r3

    x : MatrixMN
    x.m = 6
    x.n = 1
    x.arr[0] = x1
    x.arr[1] = y1
    x.arr[2] = x2
    x.arr[3] = y2
    x.arr[4] = x3
    x.arr[5] = y3
    return x

def sys_potential(q : In[MatrixMN], m : In[MatrixMN]) -&gt; float:
    x : MatrixMN = sys_coords(q)

    x1 : float = x.arr[0]
    y1 : float = x.arr[1]
    x2 : float = x.arr[2]
    y2 : float = x.arr[3]
    x3 : float = x.arr[4]
    y3 : float = x.arr[5]

    r12 : float = sqrt((x1-x2)*(x1-x2) + (y1-y2)*(y1-y2))
    r13 : float = sqrt((x1-x3)*(x1-x3) + (y1-y3)*(y1-y3))
    r23 : float = sqrt((x2-x3)*(x2-x3) + (y2-y3)*(y2-y3))

    m1 : float = m.arr[0]
    m2 : float = m.arr[2]
    m3 : float = m.arr[4]
    
    G : float = 1
    return - G * (m1*m2/r12 + m1*m3/r13 + m2*m3/r23)
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2024 Zeyu Wang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 19, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>